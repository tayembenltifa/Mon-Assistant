<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tâches - Mon Assistant</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">
            <i class="fas fa-robot"></i>
            <span>Mon Assistant</span>
        </div>
        <div class="nav-links">
            <a href="index.html" class="nav-link">
                <i class="fas fa-home"></i> Dashboard
            </a>
            <a href="tasks.html" class="nav-link active">
                <i class="fas fa-tasks"></i> Tâches
            </a>
            <a href="notes.html" class="nav-link">
                <i class="fas fa-sticky-note"></i> Notes
            </a>
            <a href="calendar.html" class="nav-link">
                <i class="fas fa-calendar"></i> Calendrier
            </a>
            <a href="goals.html" class="nav-link">
                <i class="fas fa-bullseye"></i> Objectifs
            </a>
        </div>
        <div class="nav-theme">
            <button id="themeToggle">
                <i class="fas fa-moon"></i>
            </button>
        </div>
    </nav>

    <main class="dashboard-main">
        <div class="dashboard-header">
            <h1><i class="fas fa-tasks"></i> Mes Tâches</h1>
            <p>Organise et priorise tes tâches</p>
        </div>

        <div class="quick-stats">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-list"></i>
                </div>
                <div class="stat-info">
                    <h3 id="tasksTotal">0</h3>
                    <p>Total</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-check"></i>
                </div>
                <div class="stat-info">
                    <h3 id="tasksCompleted">0</h3>
                    <p>Terminées</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-info">
                    <h3 id="tasksPending">0</h3>
                    <p>En attente</p>
                </div>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- Formulaire -->
            <div class="dashboard-widget">
                <div class="widget-header">
                    <h2><i class="fas fa-plus"></i> Nouvelle Tâche</h2>
                </div>
                <div class="widget-content">
                    <form id="taskForm">
                        <div style="margin-bottom: 1rem;">
                            <input type="text" id="taskTitle" placeholder="Titre de la tâche" style="width: 100%; padding: 0.75rem; border: 1px solid var(--gray-light); border-radius: var(--radius);">
                        </div>
                        <button type="submit" style="background: var(--primary); color: white; border: none; padding: 0.75rem 1.5rem; border-radius: var(--radius); cursor: pointer; width: 100%;">
                            <i class="fas fa-plus"></i> Ajouter la Tâche
                        </button>
                    </form>
                </div>
            </div>

            <!-- Liste des tâches -->
            <div class="dashboard-widget">
                <div class="widget-header">
                    <h2><i class="fas fa-list"></i> Liste des Tâches</h2>
                </div>
                <div class="widget-content">
                    <div id="tasksList" class="task-list">
                        <!-- Les tâches seront ajoutées ici -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="app.js"></script>
    <script>
        class TaskManager {
            constructor() {
                this.tasks = JSON.parse(localStorage.getItem('tasks')) || [];
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.renderTasks();
                this.updateStats();
            }

            setupEventListeners() {
                document.getElementById('taskForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.addTask();
                });
            }

            addTask() {
                const input = document.getElementById('taskTitle');
                const title = input.value.trim();

                if (title) {
                    const task = {
                        id: Date.now(),
                        title: title,
                        completed: false,
                        createdAt: new Date().toISOString()
                    };

                    this.tasks.push(task);
                    this.saveTasks();
                    this.renderTasks();
                    this.updateStats();
                    input.value = '';
                    
                    // Mettre à jour le dashboard principal
                    if (window.app) {
                        window.app.updateDashboard();
                    }
                }
            }

            toggleTask(id) {
                this.tasks = this.tasks.map(task => 
                    task.id === id ? { ...task, completed: !task.completed } : task
                );
                this.saveTasks();
                this.renderTasks();
                this.updateStats();
                
                if (window.app) {
                    window.app.updateDashboard();
                }
            }

            deleteTask(id) {
                if (confirm('Supprimer cette tâche ?')) {
                    this.tasks = this.tasks.filter(task => task.id !== id);
                    this.saveTasks();
                    this.renderTasks();
                    this.updateStats();
                    
                    if (window.app) {
                        window.app.updateDashboard();
                    }
                }
            }

            renderTasks() {
                const container = document.getElementById('tasksList');
                
                if (this.tasks.length === 0) {
                    container.innerHTML = '<div class="task-item">Aucune tâche pour le moment</div>';
                    return;
                }

                container.innerHTML = this.tasks.map(task => `
                    <div class="task-item ${task.completed ? 'completed' : ''}">
                        <div style="display: flex; align-items: center; gap: 1rem; width: 100%;">
                            <div onclick="taskManager.toggleTask(${task.id})" style="cursor: pointer; padding: 0.5rem;">
                                <i class="fas fa-${task.completed ? 'check-circle' : 'circle'}" style="color: ${task.completed ? 'var(--success)' : 'var(--gray)'}"></i>
                            </div>
                            <div style="flex: 1;">
                                <div class="task-title">${task.title}</div>
                                <div class="task-meta">${new Date(task.createdAt).toLocaleDateString('fr-FR')}</div>
                            </div>
                            <button onclick="taskManager.deleteTask(${task.id})" style="background: none; border: none; color: var(--danger); cursor: pointer; padding: 0.5rem;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
            }

            updateStats() {
                document.getElementById('tasksTotal').textContent = this.tasks.length;
                document.getElementById('tasksCompleted').textContent = this.tasks.filter(t => t.completed).length;
                document.getElementById('tasksPending').textContent = this.tasks.filter(t => !t.completed).length;
            }

            saveTasks() {
                localStorage.setItem('tasks', JSON.stringify(this.tasks));
            }
        }

        const taskManager = new TaskManager();
    </script>
</body>
</html>
