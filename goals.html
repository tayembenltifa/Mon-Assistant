<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Objectifs - Mon Assistant</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">
            <i class="fas fa-robot"></i>
            <span>Mon Assistant</span>
        </div>
        <div class="nav-links">
            <a href="index.html" class="nav-link">
                <i class="fas fa-home"></i> Dashboard
            </a>
            <a href="tasks.html" class="nav-link">
                <i class="fas fa-tasks"></i> Tâches
            </a>
            <a href="notes.html" class="nav-link">
                <i class="fas fa-sticky-note"></i> Notes
            </a>
            <a href="calendar.html" class="nav-link">
                <i class="fas fa-calendar"></i> Calendrier
            </a>
            <a href="goals.html" class="nav-link active">
                <i class="fas fa-bullseye"></i> Objectifs
            </a>
        </div>
        <div class="nav-theme">
            <button id="themeToggle">
                <i class="fas fa-moon"></i>
            </button>
        </div>
    </nav>

    <main class="dashboard-main">
        <div class="dashboard-header">
            <h1><i class="fas fa-bullseye"></i> Mes Objectifs</h1>
            <p>Définis et suis tes objectifs</p>
        </div>

        <div class="quick-stats">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-bullseye"></i>
                </div>
                <div class="stat-info">
                    <h3 id="goalsTotal">0</h3>
                    <p>Objectifs totaux</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-check"></i>
                </div>
                <div class="stat-info">
                    <h3 id="goalsCompleted">0</h3>
                    <p>Objectifs atteints</p>
                </div>
            </div>
        </div>

        <div class="dashboard-grid">
            <!-- Formulaire -->
            <div class="dashboard-widget">
                <div class="widget-header">
                    <h2><i class="fas fa-plus"></i> Nouvel Objectif</h2>
                </div>
                <div class="widget-content">
                    <form id="goalForm">
                        <div style="margin-bottom: 1rem;">
                            <input type="text" id="goalTitle" placeholder="Titre de l'objectif" style="width: 100%; padding: 0.75rem; border: 1px solid var(--gray-light); border-radius: var(--radius);">
                        </div>
                        <button type="submit" style="background: var(--primary); color: white; border: none; padding: 0.75rem 1.5rem; border-radius: var(--radius); cursor: pointer; width: 100%;">
                            <i class="fas fa-plus"></i> Ajouter l'Objectif
                        </button>
                    </form>
                </div>
            </div>

            <!-- Liste des objectifs -->
            <div class="dashboard-widget">
                <div class="widget-header">
                    <h2><i class="fas fa-list"></i> Mes Objectifs</h2>
                </div>
                <div class="widget-content">
                    <div id="goalsList" class="task-list">
                        <!-- Les objectifs seront ajoutés ici -->
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="app.js"></script>
    <script>
        class GoalsManager {
            constructor() {
                this.goals = JSON.parse(localStorage.getItem('goals')) || [];
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.renderGoals();
                this.updateStats();
            }

            setupEventListeners() {
                document.getElementById('goalForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.addGoal();
                });
            }

            addGoal() {
                const input = document.getElementById('goalTitle');
                const title = input.value.trim();

                if (title) {
                    const goal = {
                        id: Date.now(),
                        title: title,
                        completed: false,
                        createdAt: new Date().toISOString()
                    };

                    this.goals.push(goal);
                    this.saveGoals();
                    this.renderGoals();
                    this.updateStats();
                    input.value = '';
                    
                    // Mettre à jour le dashboard principal
                    if (window.app) {
                        window.app.updateDashboard();
                    }
                }
            }

            toggleGoal(id) {
                this.goals = this.goals.map(goal => 
                    goal.id === id ? { ...goal, completed: !goal.completed } : goal
                );
                this.saveGoals();
                this.renderGoals();
                this.updateStats();
                
                if (window.app) {
                    window.app.updateDashboard();
                }
            }

            deleteGoal(id) {
                if (confirm('Supprimer cet objectif ?')) {
                    this.goals = this.goals.filter(goal => goal.id !== id);
                    this.saveGoals();
                    this.renderGoals();
                    this.updateStats();
                    
                    if (window.app) {
                        window.app.updateDashboard();
                    }
                }
            }

            renderGoals() {
                const container = document.getElementById('goalsList');
                
                if (this.goals.length === 0) {
                    container.innerHTML = '<div class="task-item">Aucun objectif pour le moment</div>';
                    return;
                }

                container.innerHTML = this.goals.map(goal => `
                    <div class="task-item ${goal.completed ? 'completed' : ''}">
                        <div style="display: flex; align-items: center; gap: 1rem; width: 100%;">
                            <div onclick="goalsManager.toggleGoal(${goal.id})" style="cursor: pointer; padding: 0.5rem;">
                                <i class="fas fa-${goal.completed ? 'check-circle' : 'circle'}" style="color: ${goal.completed ? 'var(--success)' : 'var(--gray)'}"></i>
                            </div>
                            <div style="flex: 1;">
                                <div class="task-title">${goal.title}</div>
                                <div class="task-meta">${new Date(goal.createdAt).toLocaleDateString('fr-FR')}</div>
                            </div>
                            <button onclick="goalsManager.deleteGoal(${goal.id})" style="background: none; border: none; color: var(--danger); cursor: pointer; padding: 0.5rem;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                `).join('');
            }

            updateStats() {
                document.getElementById('goalsTotal').textContent = this.goals.length;
                document.getElementById('goalsCompleted').textContent = this.goals.filter(g => g.completed).length;
            }

            saveGoals() {
                localStorage.setItem('goals', JSON.stringify(this.goals));
            }
        }

        const goalsManager = new GoalsManager();
    </script>
</body>
</html>
